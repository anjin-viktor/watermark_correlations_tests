# Watermark Correlations Tests

This repository contains Python scripts, a C++ implementation of digital watermarks, and evaluation results used in the paper *"An algorithm for evaluation correlation estimation methods used in correlation based digital watermarks."*

## Annotation

The paper proposes an algorithm for evaluating correlation estimation methods. The algorithm is based on an experiment that counts the number of successful watermark detections in an image dataset after the images are distorted by filtering. Detection thresholds for various correlation estimation methods are selected such that a slight decrease results in at least one false positive detection.

The algorithm was tested using linear correlation, the correlation coefficient, and the Pearson correlation coefficient within a watermark embedding and detection method based on the discrete cosine transform (DCT). The results of the experimental evaluation demonstrate that the Pearson correlation coefficient achieves the highest detection performance.

**Keywords:** digital watermarking, linear correlation, Pearson coefficient, correlation coefficient, content protection

## C++ Implementation of Watermarks Used in the Paper

The watermarking method used in the paper is:

**DCT-based watermarking**, described in *"Cox I. J. et al. Secure Spread Spectrum Watermarking for Multimedia," IEEE Transactions on Image Processing, 1997, Vol. 6, No. 12, pp. 1673-1687.*

The C++ source code for these implementations is available in the `watermarks_implementation` directory, along with build instructions in the `README.md` file.

## Python Scripts

For working with watermark, Python wrapper located in the `watermarks` directory is used. You need to update the paths to the executables compiled in the `watermarks_implementation` directory within these scripts.

Python scripts operate on images located in the `images` directory. The images used in the paper are from:  
*"Rashtchian C. et al. Collecting image annotations using amazon’s mechanical turk //Proceedings of the NAACL HLT 2010 workshop on creating speech and language data with Amazon’s Mechanical Turk. – 2010. – С. 139-147."*

The scripts include:

- **`main.py`** – Runs the complete processing pipeline.  
- **`embed_watermarks.py`** – Embeds watermarks into images from the `images` directory.  
- **`calc_correlations.py`** – Calculates correlation values for the image dataset and stores the results in a `.csv` file.  
- **`find_threshold.py`** – Computes detection thresholds using Algorithm 1, based on `.csv` files generated by `calc_correlations.py`.  
- **`filter_watermarks.py`** – Applies filters to the watermarked images according to Algorithm 2.  
- **`detect_watermark.py`** – Computes the number of successful watermark detections based on specified detection thresholds and previously calculated correlation values.  
- **`plot_thresholds.py`** – Visualizes the detection thresholds selected by Algorithm 1 alongside the calculated correlation values.

## Evaluation Results

Evaluation results are stored in the `results` directory as `.csv` files and in a `result` file.